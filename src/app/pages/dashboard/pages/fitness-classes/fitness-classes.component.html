<div class="fitness-classes-container">
  <mat-card class="header-card">
    <div class="header-content">
      <div class="header-text">
        <mat-card-title>üí™ ZarzƒÖdzanie zajƒôciami</mat-card-title>
        <mat-card-subtitle>PrzeglƒÖdaj i zarzƒÖdzaj wszystkimi zajƒôciami fitness</mat-card-subtitle>
      </div>
      <button mat-raised-button color="primary" (click)="addClass()" *ngIf="currentUser?.Role === 'admin' || currentUser?.Role === 'trainer'">
        <mat-icon>add</mat-icon>
        Dodaj zajƒôcia
      </button>
    </div>
  </mat-card>

  <mat-tab-group class="classes-tabs">
    <!-- NadchodzƒÖce zajƒôcia -->
    <mat-tab label="üìÖ NadchodzƒÖce">
      <div class="tab-content">
        <div *ngIf="upcomingClasses$ | async as classes; else loadingUpcoming">
          <div *ngIf="classes.length === 0" class="no-classes">
            <mat-icon>event_busy</mat-icon>
            <h3>Brak nadchodzƒÖcych zajƒôƒá</h3>
            <p>Nie ma zaplanowanych zajƒôƒá w najbli≈ºszym czasie.</p>
          </div>
          
          <div *ngFor="let classItem of classes" class="class-card">
            <div class="class-header">
              <h3>{{ classItem.Title }}</h3>
              <mat-chip [color]="getStatusColor(classItem.Status)" selected>
                {{ getStatusText(classItem.Status) }}
              </mat-chip>
            </div>
            
            <div class="class-details">
              <div class="detail-item">
                <mat-icon>schedule</mat-icon>
                <span>{{ formatDate(classItem.StartTime) }}</span>
              </div>
              
              <div class="detail-item">
                <mat-icon>room</mat-icon>
                <span>Sala {{ classItem.RoomID }}</span>
              </div>
              
              <div class="detail-item">
                <mat-icon>people</mat-icon>
                <span>Miejsca: {{ classItem.availableSpots || 0 }}/{{ classItem.Capacity }}</span>
              </div>
              
              <div class="detail-item" *ngIf="classItem.currentReservations > 0">
                <mat-icon>event_seat</mat-icon>
                <span>Zapisanych: {{ classItem.currentReservations }}</span>
              </div>
              
              <div class="detail-item" *ngIf="classItem.TrainerID">
                <mat-icon>person</mat-icon>
                <span>Trener ID: {{ classItem.TrainerID }}</span>
              </div>
            </div>
            
            <div class="class-actions">
              <button mat-raised-button color="primary" (click)="editClass(classItem)">
                <mat-icon>edit</mat-icon>
                Edytuj
              </button>
              <button mat-raised-button color="warn" (click)="deleteClass(classItem)">
                <mat-icon>delete</mat-icon>
                Usu≈Ñ
              </button>
            </div>
          </div>
        </div>
        
        <ng-template #loadingUpcoming>
          <div class="loading">
            <mat-icon>refresh</mat-icon>
            <p>≈Åadowanie nadchodzƒÖcych zajƒôƒá...</p>
          </div>
        </ng-template>
      </div>
    </mat-tab>

    <!-- Zako≈Ñczone zajƒôcia -->
    <mat-tab label="üìã Zako≈Ñczone">
      <div class="tab-content">
        <div *ngIf="pastClasses$ | async as classes; else loadingPast">
          <div *ngIf="classes.length === 0" class="no-classes">
            <mat-icon>history</mat-icon>
            <h3>Brak zako≈Ñczonych zajƒôƒá</h3>
            <p>Nie ma jeszcze zako≈Ñczonych zajƒôƒá w systemie.</p>
          </div>
          
          <div *ngFor="let classItem of classes" class="class-card past-class">
            <div class="class-header">
              <h3>{{ classItem.Title }}</h3>
              <mat-chip [color]="getStatusColor(classItem.Status)" selected>
                {{ getStatusText(classItem.Status) }}
              </mat-chip>
            </div>
            
            <div class="class-details">
              <div class="detail-item">
                <mat-icon>schedule</mat-icon>
                <span>{{ formatDate(classItem.StartTime) }}</span>
              </div>
              
              <div class="detail-item">
                <mat-icon>room</mat-icon>
                <span>Sala {{ classItem.RoomID }}</span>
              </div>
              
              <div class="detail-item">
                <mat-icon>people</mat-icon>
                <span>Miejsca: {{ classItem.availableSpots || 0 }}/{{ classItem.Capacity }}</span>
              </div>
              
              <div class="detail-item" *ngIf="classItem.currentReservations > 0">
                <mat-icon>event_seat</mat-icon>
                <span>Zapisanych: {{ classItem.currentReservations }}</span>
              </div>
              
              <div class="detail-item" *ngIf="classItem.TrainerID">
                <mat-icon>person</mat-icon>
                <span>Trener ID: {{ classItem.TrainerID }}</span>
              </div>
            </div>
          </div>
        </div>
        
        <ng-template #loadingPast>
          <div class="loading">
            <mat-icon>refresh</mat-icon>
            <p>≈Åadowanie zako≈Ñczonych zajƒôƒá...</p>
          </div>
        </ng-template>
      </div>
    </mat-tab>

    <!-- Wszystkie zajƒôcia -->
    <mat-tab label="üìä Wszystkie">
      <div class="tab-content">
        <div *ngIf="allClasses$ | async as classes; else loadingAll">
          <div class="classes-summary">
            <mat-card class="summary-card">
              <mat-card-title>Podsumowanie</mat-card-title>
              <div class="summary-stats">
                <div class="stat-item">
                  <span class="stat-number">{{ classes.length }}</span>
                  <span class="stat-label">Wszystkich zajƒôƒá</span>
                </div>
                <div class="stat-item">
                  <span class="stat-number">{{ (upcomingClasses$ | async)?.length || 0 }}</span>
                  <span class="stat-label">NadchodzƒÖcych</span>
                </div>
                <div class="stat-item">
                  <span class="stat-number">{{ (pastClasses$ | async)?.length || 0 }}</span>
                  <span class="stat-label">Zako≈Ñczonych</span>
                </div>
              </div>
            </mat-card>
          </div>
          
          <div *ngFor="let classItem of classes" class="class-card">
            <div class="class-header">
              <h3>{{ classItem.Title }}</h3>
              <mat-chip [color]="getStatusColor(classItem.Status)" selected>
                {{ getStatusText(classItem.Status) }}
              </mat-chip>
            </div>
            
            <div class="class-details">
              <div class="detail-item">
                <mat-icon>schedule</mat-icon>
                <span>{{ formatDate(classItem.StartTime) }}</span>
              </div>
              
              <div class="detail-item">
                <mat-icon>room</mat-icon>
                <span>Sala {{ classItem.RoomID }}</span>
              </div>
              
              <div class="detail-item">
                <mat-icon>people</mat-icon>
                <span>Miejsca: {{ classItem.availableSpots || 0 }}/{{ classItem.Capacity }}</span>
              </div>
              
              <div class="detail-item" *ngIf="classItem.currentReservations > 0">
                <mat-icon>event_seat</mat-icon>
                <span>Zapisanych: {{ classItem.currentReservations }}</span>
              </div>
              
              <div class="detail-item" *ngIf="classItem.TrainerID">
                <mat-icon>person</mat-icon>
                <span>Trener ID: {{ classItem.TrainerID }}</span>
              </div>
            </div>
            
            <div class="class-actions">
              <button mat-raised-button color="primary" (click)="editClass(classItem)">
                <mat-icon>edit</mat-icon>
                Edytuj
              </button>
              <button mat-raised-button color="warn" (click)="deleteClass(classItem)">
                <mat-icon>delete</mat-icon>
                Usu≈Ñ
              </button>
            </div>
          </div>
        </div>
        
        <ng-template #loadingAll>
          <div class="loading">
            <mat-icon>refresh</mat-icon>
            <p>≈Åadowanie wszystkich zajƒôƒá...</p>
          </div>
        </ng-template>
      </div>
    </mat-tab>
  </mat-tab-group>
</div>